---
title: Linux内核之编程注意事项
date: 2018-04-04 11:27:28
tags:
	- Linux内核
---



```
1、内核编程时，不能使用C库，也不能访问标准的C头文件。
	造成这个结果的原因有很多，其中就包括先有鸡还是先有蛋的悖论。
	最主要的原因还是大小和速度的考虑。
	内核里实现了大部分的常用函数。
	在没有实现的函数里，最著名的就是printf函数了。内核实现了对等的printk函数。
	
2、内核编程必须使用gnu C。
	用到了很多的扩展语法。
	最主要的有：
	1）inline函数。
	2）嵌入汇编。
	3）分支声明。if(unlikely(error))。对于 条件选择，gcc內建了一条指令用于优化。
		这个重点是要判断正确，如果弄错了，性能反而下降。
	
3、内核编程缺乏内存保护机制。
	
4、内核编程难以执行浮点运算。
	在用户空间的进程进行浮点操作的时候，内核会进行从整数操作到浮点数操作的转换。
	不要在内核里做浮点运算。
5、内核每个线程只有很小的定长堆栈。
6、必须时刻注意并发问题。
7、要考虑可移植性的重要性。
```

