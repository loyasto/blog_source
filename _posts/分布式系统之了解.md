---
title: 分布式系统之了解
date: 2017-12-31 20:31:41
tags:
	- 分布式系统
typora-root-url: ..\
---



之前做的一直是嵌入式开发，对分布式系统没有了解。现在要做一个基础的了解。



# 分布式系统的概念

与分布式系统对应的，就是集中式系统。我们先从集中式系统说起。集中式系统先出现，因为有了缺点，才发展出了分布式系统，了解需求的来源很重要。

集中式系统，简单说就是，一个主机带多个终端。我们开发用的服务器就相当于一个集中式系统。

集中式的优点很明显，就是部署结构很简单。

缺点是：系统大而复杂，出故障影响大，可扩展性差。

分布式系统的定义是这样：

一个软件组件分布在不同的网络计算机上，彼此之间通过消息进行通信和协调的系统。

对外的表现是，一群计算机一起提供服务，用户看起来，就像是在访问一台电脑一样。

有了分布式系统，就不需要很高性能的服务器，而用多台普通的电脑来达到目的。

分布式系统分布在网络上，所以没有空间限制。主要有如下特征：

1、分布性。计算机之间没有主从之分。

2、透明性。每台计算机可以访问其他的计算机的资源，就像访问自己的一样。

3、同一性。大家合力完成一个任务。



# 分布式系统应用场景

一般我们会在哪些场景使用分布式系统呢？

1、分布式应用。对应用进行分层和分割，然后分布式部署。

2、分布式静态资源。对网站的静态资源，例如js、css，图片等资源可以进行分布式部署，减轻应用服务器的负担，提高访问速度。

3、分布式数据和存储。海量的数据，要分布在不同的服务器上才能存的下。

4、分布式计算。这个很常见，就是有些很耗费计算力的科学计算，可以分发到广大网友的电脑进行分布式计算。



#分布式和集群的区别

1、分布式强调机器间的协作，重点是任务可拆分。例如，某个任务，一个机器跑，要10个小时，拆分给10个机器跑，可能2个小时就跑完了。

2、集群强调的是10台机器干同一件事情。一个任务，在一台机器上跑，要10个小时，在10台机器的集群上跑，还是要10个小时。其实相当于有9台在闲着没干活。



# 一个例子讲述公司的服务器部署发展过程

小明的公司有3个系统，系统A、系统B、系统C。分别部署在服务器1、服务器2、服务器3上面。

三个系统之间相互调用，一起来完成公司的业务流程。

这就是一个简单的分布式系统。

拓扑图如下：

![分布式系统之了解-图1](/images/分布式系统之了解-图1.png "分布式系统之了解-图1")

系统A是入口。如果访问量大的话，A可能会崩溃掉。A崩溃了，那么整个系统就崩溃了。这种情况叫做单点失败。

那么一个很自然的做法就是给系统A做备份服务器。

小明的公司不差钱，就另外买了两台服务器，之前的服务器1改名为服务器1.1，新的两台分别是服务器1.2，服务器1.3 。这三台服务器就是构成了一个集群。这3台服务器上都是部署的系统A。

但是用户是通过ip地址找到系统A的。现在1.1/1.2/1.3的ip地址都不一样，到底访问哪一个呢？

如果都访问1.1的话，那么1.1会累死，1.2和1.3也就是摆设了。

接下来就是要引入负载均衡的概念了。

假如同时有3万个用户在访问系统A。那么最理想的情况就是让三个运行系统A的服务器各处理1万个。这就是负载均衡。负载均衡这个事情，nginx就可以干的。这个工作，也专门配置一台服务器来做。就是服务器4。现在拓扑结构变成这样了：

![分布式系统之了解-图2](/images/分布式系统之了解-图2.png "分布式系统之了解-图2")

服务器4虽然只干负载均衡这个事情，负担不重，但是如果挂了，还是有单点的问题存在。

好吧。那就再给服务器4搞一个集群，另外再配一台服务器4.2。

拓扑结构变成下面这样：

![分布式系统之了解-图3](/images/分布式系统之了解-图3.png "分布式系统之了解-图3")

负载均衡的集群，虽然也有2台机器，但是我们可以通过技术手段，让它们对外只提供一个ip地址，用户看起来就是同一个机器。

现在的架构已经基本比较完善，但是还是有不能处理的场景。

例如双十一的淘宝服务器负担会有一个异常的猛增情况。

假如出现了访问洪峰，3套系统A已经处理不了了。增加服务器吗？假如峰值时需要10台系统A服务器。那么新增的7台服务器在大部分时候是闲置状态，这个无疑是不必要的。

于是，小明决定尝试一下现在流行的云计算。在云端可以很简单增加较少服务器的数量。

上面说了这么多，还没有提及系统A的具体业务。假如是网上购物的业务，假如用户当前的请求被服务器1.1处理着呢，突然服务器1.1挂了。用户的请求被转移到服务器1.2来处理。

但是，服务器1.1上已经添加的购物车商品，服务器1.2怎样知道呢？如果这些处理不好，集群达到的效果就不好。

有两种解决方法：

1、把用户状态信息在各个服务器上都复制一份，WebLogic这种server程序会这么做的。

2、专门配一台服务器来保存用户状态信息。Redis就是干这个的。





