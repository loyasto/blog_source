---
title: C语言之stdio缓冲区
date: 2018-02-06 10:58:01
tags:
	- C语言

---



# 为什么需要缓冲

1、从用户态到内核态，切换需要时间。

2、硬盘写入也要时间。

如果如果可以把内容集中起来，一次性进行写入，对效率提高是很有用的。



讨论stdio的时候，我们就是在讨论标准io库。标准io库的函数大部分都是以字母f开头的。

操作的核心数据结构是FILE。

fopen、fread、fwrite。printf是file指向stdout的fprintf。

unistd.h里的read、write这些，是没有缓冲的。



fread里就是封装了read的操作。我们就是要减少read这种函数调用的次数。



#当前有哪些缓冲手段？

有3种缓冲：

1、全缓冲。填满缓冲区之后，才进行write等操作。

2、行缓冲。对于跟终端相关的，都是行缓冲。

3、无缓冲。你可以关闭掉缓冲功能。

stderr是不带缓冲的。这样错误信息就可以及时爆出来。

你可以通过setvbuf函数来设置这些缓冲形式。还可以调整缓冲区的大小。



