---
title: S3C2410芯片手册梳理
date: 2018-03-24 11:21:27
tags:
	- S3C2410

---



看2.6.35的内核代码，用2410的作为参考的板子。为了理解一些代码，把2410的芯片手册过一遍。

2.6版本时候的arm代码虽然比较多，但是看起来会好点，后面的版本，把很多内容放到了设备树里，看起来就没有那么直观。

我们先make s3c2410_defconfig，得到autoconf.h。这个我们拷贝到源代码目录下，方便看配置的定义。

我们把芯片相关的重要的列出来。

```
CONFIG_VECTORS_BASE=0xffff0000
CONFIG_ARCH_S3C2410=y
CONFIG_PLAT_SAMSUNG=y
CONFIG_PLAT_S3C24XX=y
CONFIG_CPU_S3C2410=y
CONFIG_ARCH_SMDK2410=y  这里有一堆的子系列的。
CONFIG_MACH_SMDK2413=y
CONFIG_MACH_S3C2413=y
CONFIG_MACH_SMDK2412=y

CONFIG_ARCH_S3C2440=y  

下面的这些配置注意。
CONFIG_CPU_ARM920T=y
CONFIG_CPU_ARM926T=y
CONFIG_CPU_32v4T=y
CONFIG_CPU_32v5=y
CONFIG_CPU_ABRT_EV4T=y
CONFIG_CPU_ABRT_EV5TJ=y
CONFIG_CPU_PABRT_LEGACY=y
CONFIG_CPU_CACHE_V4WT=y
CONFIG_CPU_CACHE_VIVT=y
CONFIG_CPU_COPY_V4WB=y
CONFIG_CPU_TLB_V4WBI=y
CONFIG_CPU_CP15=y
CONFIG_CPU_CP15_MMU=y


CONFIG_VMSPLIT_3G=y
CONFIG_PAGE_OFFSET=0xC0000000

CONFIG_ZBOOT_ROM_TEXT=0x0
CONFIG_ZBOOT_ROM_BSS=0x0
CONFIG_CMDLINE="root=/dev/hda1 ro init=/bin/bash console=ttySAC0"

CONFIG_PM=y

```



要把mach-s3c2412目录的代码添加进来。

```
./arch/arm/mach-s3c2412/s3c2412.c:56:void __iomem *s3c24xx_va_gpio2 = S3C24XX_VA_GPIO;
./arch/arm/mach-s3c2412/s3c2412.c:60:   s3c24xx_va_gpio2 = S3C24XX_VA_GPIO + 0x10;
```



三星的这些目录的关系是什么？

先看arch/arm目录下的Makefile。



CONFIG_ARCH 

CONFIG_PLAT

CONFIG_MACH

这三个的层次关系是什么？

arch的，2440和2410都是y。

plat的。samsung和s3c24xx都是y。

CONFIG_PLAT_SAMSUNG=y

CONFIG_PLAT_S3C24XX=y

machine的有一堆。

```
	Line 288: CONFIG_MACH_SMDK=y
	Line 303: CONFIG_MACH_BAST_IDE=y
	Line 312: CONFIG_MACH_N30=y
	Line 313: CONFIG_MACH_N35=y
	Line 315: CONFIG_MACH_OTOM=y
	Line 316: CONFIG_MACH_AML_M5900=y
	Line 318: CONFIG_MACH_TCT_HAMMER=y
	Line 319: CONFIG_MACH_VR1000=y
	Line 320: CONFIG_MACH_QT2410=y
	Line 328: CONFIG_MACH_JIVE=y
	Line 329: # CONFIG_MACH_JIVE_SHOW_BOOTLOADER is not set
	Line 330: CONFIG_MACH_SMDK2413=y
	Line 331: CONFIG_MACH_S3C2413=y
	Line 332: CONFIG_MACH_SMDK2412=y
	Line 333: CONFIG_MACH_VSTMS=y
	Line 340: CONFIG_MACH_SMDK2416=y
	Line 351: CONFIG_MACH_ANUBIS=y
	Line 352: CONFIG_MACH_NEO1973_GTA02=y
	Line 353: CONFIG_MACH_OSIRIS=y
	Line 354: CONFIG_MACH_OSIRIS_DVS=m
	Line 355: CONFIG_MACH_RX3715=y
	Line 357: CONFIG_MACH_NEXCODER_2440=y
	Line 360: CONFIG_MACH_AT2440EVB=y
	Line 361: CONFIG_MACH_MINI2440=y
	Line 362: CONFIG_MACH_RX1950=y
	Line 369: CONFIG_MACH_SMDK2443=y
```

会编译哪些东西？

```
core-y				+= arch/arm/kernel/ arch/arm/mm/ arch/arm/common/
core-y				+= $(machdirs) $(platdirs)
core-$(CONFIG_FPE_NWFPE)	+= arch/arm/nwfpe/
core-$(CONFIG_FPE_FASTFPE)	+= $(FASTFPE_OBJ)
core-$(CONFIG_VFP)		+= arch/arm/vfp/
```

1、kernel目录下的。mm目录的。comm目录的。

这3个目录的都是跟具体芯片无关的。只跟arm架构有关。

2、`$(machdirs) $(platdirs)`

我在Makefile里加打印看看，当前实际上是编译了哪些。

```
 -------arch/arm/mach-s3c2410/ arch/arm/mach-s3c2400/ arch/arm/mach-s3c2412/ arch/arm/mach-s3c2416/ arch/arm/mach-s3c2440/ arch/arm/mach-s3c2443/ -----------arch/arm/plat-s3c24xx/ arch/arm/plat-samsung/--------
```

mach有：2410 、2400、 2412、 2416、 2440 、2443 。

plat有：24xx、samsumg。

我们看看这些目录下分别有什么。

mach-xxx的。下面的函数类似。就是名字的前缀不同。

