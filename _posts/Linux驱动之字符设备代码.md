---
title: Linux驱动之字符设备代码
date: 2018-03-23 21:29:42
tags:
	- Linux驱动

---



之前都只是用char dev的api。还没有认真分析char_dev.c里的代码。很多东西不清楚。现在就看看。

首先一点，char_dev.c是在linux/fs目录下，第一点就值得思考。

char_dev.c不是作为驱动的一部分，而是作为文件系统的一部分。

我就按照从上到下的顺序，把这个文件理一遍。

我觉得这个文件的主要作用是为了sysfs里的那点东西。其余的没啥。





找动态的major的方法

```
1、从255开始，到235结束。所以可选的范围就是21个。
	找到了，就返回。否则继续下一步。
2、从511开始，到385结束。
	没看懂这一步是要干啥。不管。先就按第一步的理解就好了。
```

