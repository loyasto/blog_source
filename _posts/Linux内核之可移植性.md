---
title: Linux内核之可移植性
date: 2018-04-04 10:48:21
tags:
	- Linux内核

---



# Linux内核的移植历史

1、最初，Linux只在x86上跑。

2、1993年，大家开始往Digital Alpha上移植。这个一种RISC架构的，64位CPU。跟x86差别很大，移植花了大概一年。不过之后的移植就简单多了。这个是探索性的。

3、1.2版本的内核，支持了mips和SPARC。不太完善，是实验性质的。

4、2.0版本，加入68000系列和PowerPC的官方支持。

5、2.2版本，加入了对ARM的支持。

6、到2.4版本，总共支持15种CPU架构。

# 字长和数据类型

能够由CPU一次处理完的数据称为字。

64位机器的字长就是64位。

对于支持的每一种架构，Linux都需要将`<asm/types.h>`里的BITS_PER_LONG定义为系统字长。

C语言只规定了类型的最小长度，但是没有规定标准长度。

这个有好有坏。我觉得坏处比较大。

我们记住下面这些原则：

```
1、ANSI C规定，一个char一定是1字节。
2、尽管没有规定int类型的长度一定是32位，但是linux支持的架构里，都是32位的。
3、short也都是16位。
4、指针和long的长度，有32位和64位两种可能。
```

## 不透明数据类型

就是pid_t、atomic_t这种类型。

## 长度明确的类型

就是u8、u32这种。

这些只能在内核里使用，不可以在用户空间使用。

这种限制是为了保护命名空间。

## 数据对齐

